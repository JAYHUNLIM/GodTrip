<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
     "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
     
<mapper namespace="hotel">
	
		<select id="list" resultType="java.util.Map">        
       SELECT *
       FROM (
        SELECT hotel_code, arrival_code, hotel_Name, hotel_Content, hotel_Prices, hotel_filename, hotel_filesize, hotel_address, hotel_tel
        FROM hotel
        WHERE arrival_code = #{area_code}
        <if test="hotel_Name != null and hotel_Name != ''">
            AND hotel_Name LIKE CONCAT('%', #{hotel_Name}, '%')
        </if>
        <if test="hotel_Type != null and hotel_Type != ''">
            AND hotel_Type = #{hotel_Type}
        </if>
        ORDER BY hotel_Name
        LIMIT #{endRow} OFFSET #{startRow}
    ) AS subquery
	    </select>
	    
	    
	    
	    <select id="list2" resultType="java.util.Map">
		SELECT DISTINCT room.room_code, room.hotel_code, room.p_ID, room.room_Name, room.room_price, room.room_filename, room.room_filesize, room.room_info, room.room_maxperson, hotel.hotel_Name, hotel.hotel_filename, hotel.hotel_Content, hotel.hotel_address
		FROM room
		JOIN hotel ON room.hotel_code = hotel.hotel_code
		WHERE room.hotel_code = #{hotel_code}
	    </select>
	    
	    
	    
	  
		
		<insert id="insert" parameterType="java.util.Map">
		INSERT INTO hotel (hotel_code, arrival_code, hotel_Type, hotel_Name, hotel_Prices, hotel_filename, hotel_filesize, hotel_Content,hotel_tel,hotel_address)
		VALUES(#{hotel_code}, #{arrival_code}, #{hotel_Type}, #{hotel_Name}, #{hotel_Prices}, #{hotel_filename},#{hotel_filesize},#{hotel_Content},#{hotel_tel},#{hotel_address})
		</insert>
	
		<insert id="detailinsert" parameterType="java.util.Map">
		INSERT INTO room (room_code,hotel_code,p_ID,room_Name,room_price,room_filename, room_filesize, room_info,room_maxperson)
		VALUES(#{room_code}, #{hotel_code}, #{p_ID}, #{room_Name}, #{room_price}, #{room_filename},#{room_filesize},#{room_info},#{room_maxperson})
		</insert>
	
	
		<!-- 전체 레코드 수 조회 -->
	    <select id="totalRowCount" resultType="java.lang.Integer">
	        SELECT COUNT(*) FROM hotel WHERE arrival_code = #{area_code}
	        <if test="hotel_Name != null and hotel_Name != ''">
            AND hotel_Name LIKE CONCAT('%', #{hotel_Name}, '%')
        	</if>
        	<if test="hotel_Type != null and hotel_Type != ''">
            AND hotel_Type = #{hotel_Type}
       		</if>
	    </select>
	    
	    
	    
</mapper>